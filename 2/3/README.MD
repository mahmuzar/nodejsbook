–í backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –Ω–∞ Node.js —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –¥–æ–ª–≥–æ –∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞. –ù–∏–∂–µ ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é —É—Ç–µ—á–µ–∫ —Å –ø–æ–º–æ—â—å—é heapdump –∏ Clinic.js, –∞ —Ç–∞–∫–∂–µ –æ–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
____
## üîç 1. heapdump ‚Äî —Ä—É—á–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–∞–º–ø–æ–≤ –∫—É—á–∏
## ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install heapdump
```

## ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:

```js
const heapdump = require('heapdump');
```

## ‚úÖ –°–ø–æ—Å–æ–±—ã —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–º–ø–∞:
__a) –í—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ç–∞–π–º–µ—Ä—É –∏–ª–∏ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏):__

```js
// –ß–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞
setTimeout(() => {
  const filename = heapdump.writeSnapshot();
  console.log('Heap snapshot saved:', filename);
}, 30_000);
```

__–±) –ü–æ —Å–∏–≥–Ω–∞–ª—É –û–° (—É–¥–æ–±–Ω–æ –≤ production):__

```bash
kill -USR2 <PID_—Ç–≤–æ–µ–≥–æ_node_–ø—Ä–æ—Ü–µ—Å—Å–∞>
```

‚Üí –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ SIGUSR‚ÇÇ heapdump –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç .heapsnapshot –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.

> üí° –ò–º—è —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç –≤–∏–¥–∞ heapdump-1234567890.heapsnapshot.

## üîé –ê–Ω–∞–ª–∏–∑ –¥–∞–º–ø–∞:

1. –û—Ç–∫—Ä–æ–π Chrome DevTools ‚Üí –≤–∫–ª–∞–¥–∫–∞ Memory.
2. –ù–∞–∂–º–∏ "Load" –∏ –≤—ã–±–µ—Ä–∏ —Ñ–∞–π–ª .heapsnapshot.
3. –ò—Å–ø–æ–ª—å–∑—É–π:
    - Summary ‚Äî –ø–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞–Ω–∏–º–∞—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–∞–º—è—Ç–∏.
    - Comparison ‚Äî —Å—Ä–∞–≤–Ω–∏ –¥–≤–∞ —Å–Ω–∏–º–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ 10 –º–∏–Ω –∏ —á–µ—Ä–µ–∑ 60 –º–∏–Ω). –ò—â–∏ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—Ç—É—Ç –±–µ–∑ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è.
4. –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞:
    - –ú–∞—Å—Å–∏–≤—ã/–æ–±—ä–µ–∫—Ç—ã —Å —Ä–∞—Å—Ç—É—â–∏–º —Ä–∞–∑–º–µ—Ä–æ–º.
    - –ó–∞–º—ã–∫–∞–Ω–∏—è ((closure)), —É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ —Å—Å—ã–ª–∫–∏.
    - –ù–µ–æ—á–∏—â–µ–Ω–Ω—ã–µ EventEmitter'—ã, —Ç–∞–π–º–µ—Ä—ã, WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

## ü©∫ 2. Clinic.js ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫ (–æ—Ç NearForm)

Clinic.js –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.

## ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
npm install -g clinic
```

## ‚úÖ –ó–∞–ø—É—Å–∫ —Å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–∞–º—è—Ç–∏:

```bash
clinic heap -- node app.js
# –∏–ª–∏
clinic heap -- npm start
```


> ‚ö†Ô∏è Clinic –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞–∂–º—ë—à—å Ctrl+C. –ó–∞—Ç–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç.

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:

- –û—Ç–∫—Ä–æ–µ—Ç—Å—è HTML-–æ—Ç—á—ë—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∏–ª–∏ –ø—É—Ç—å –∫ –Ω–µ–º—É –≤ –∫–æ–Ω—Å–æ–ª–∏).
- –¢—ã —É–≤–∏–¥–∏—à—å –≥—Ä–∞—Ñ–∏–∫ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
- –ú–æ–∂–Ω–æ –∫–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –º–æ–º–µ–Ω—Ç—ã —Ä–æ—Å—Ç–∞ ‚Üí —É–≤–∏–¥–µ—Ç—å —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤, –≥–¥–µ –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞–ª–∏—Å—å –æ–±—ä–µ–∫—Ç—ã.

## ‚úÖ –°–æ–≤–µ—Ç—ã:

- –ó–∞–ø—É—Å–∫–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ autocannon –∏–ª–∏ k6), —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ —É—Ç–µ—á–∫–∏:

```bash
# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã clinic)
autocannon -c 10 -d 60 http://localhost:3000/api/some-endpoint
```

- –ò—â–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –∏–∑ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ.

## üõ†Ô∏è –û–±—â–∏–µ –ø—Ä–∏—á–∏–Ω—ã —É—Ç–µ—á–µ–∫ –≤ Node.js backend

## üõë –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ –≤ Node.js

## üõë –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ –≤ Node.js

| –ü—Ä–∏—á–∏–Ω–∞                             | –ü—Ä–∏–º–µ—Ä                                                                 | –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å                                                                 |
|-------------------------------------|------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã / –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –∫—ç—à–∏** | `const logs = []; app.post('/log', (req) => logs.push(req.body))`      | –û–≥—Ä–∞–Ω–∏—á—å —Ä–∞–∑–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `LRU cache`) –∏–ª–∏ –æ—á–∏—â–∞–π –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é |
| **–ù–µ—É–¥–∞–ª—ë–Ω–Ω—ã–µ —Å–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π**   | `emitter.on('data', handler)` –±–µ–∑ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ `emitter.off()`         | –í—Å–µ–≥–¥–∞ —É–¥–∞–ª—è–π —Å–ª—É—à–∞—Ç–µ–ª–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (`close`, `destroy`) |
| **–ó–∞–º—ã–∫–∞–Ω–∏—è, —É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ `req`/`res`** | Middleware –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∞—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞–¥–æ–ª–≥–æ | –ò–∑–±–µ–≥–∞–π —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ `req`/`res` –≤–Ω–µ –∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞                |
| **–¢–∞–π–º–µ—Ä—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏** | `const id = setInterval(() => {}, 1000)` –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∑–∞–ø—Ä–æ—Å–∞         | –°–æ—Ö—Ä–∞–Ω—è–π ID –∏ –≤—ã–∑—ã–≤–∞–π `clearTimeout(id)` / `clearInterval(id)` –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏  |
| **–û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–µ, –Ω–æ –Ω–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** | WebSocket –∏–ª–∏ long-polling: –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª—é—á–∏–ª—Å—è, –Ω–æ –æ–±—ä–µ–∫—Ç –æ—Å—Ç–∞–ª—Å—è –≤ –ø–∞–º—è—Ç–∏ | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å–æ–±—ã—Ç–∏—è `close`, `disconnect` –∏ —É–¥–∞–ª—è–π —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã           |

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã / –¥–æ–ø. –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- process.memoryUsage() ‚Äî –ª–æ–≥–∏—Ä—É–π –≤ –ø—Ä–æ–¥–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç—Ä–µ–Ω–¥–æ–≤:

```js
setInterval(() => {
  const mem = process.memoryUsage();
  console.log(`RSS: ${mem.rss / 1024 / 1024} MB, Heap: ${mem.heapUsed / 1024 / 1024} MB`);
}, 60_000);
```

- --inspect + Chrome DevTools ‚Äî –ø–æ–¥–∫–ª—é—á–∞–π—Å—è –∫ —Ä–∞–±–æ—Ç–∞—é—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –∏ –¥–µ–ª–∞–π —Å–Ω–∏–º–∫–∏ –≤—Ä—É—á–Ω—É—é.
- Prometheus + Grafana ‚Äî –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—á–µ—Ä–µ–∑ prom-client).

## üí° –†–µ–∑—é–º–µ

- –ò—Å–ø–æ–ª—å–∑—É–π Clinic HeapProfiler –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
- –ò—Å–ø–æ–ª—å–∑—É–π heapdump –¥–ª—è —Ç–æ—á–µ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤ production (–ø–æ —Å–∏–≥–Ω–∞–ª—É).
- –°—Ä–∞–≤–Ω–∏–≤–∞–π –¥–≤–∞ –∏ –±–æ–ª–µ–µ heap snapshot'–∞ ‚Äî —ç—Ç–æ –∫–ª—é—á –∫ –≤—ã—è–≤–ª–µ–Ω–∏—é —É—Ç–µ—á–µ–∫.
- –ß–∞—â–µ –≤—Å–µ–≥–æ —É—Ç–µ—á–∫–∏ –≤—ã–∑–≤–∞–Ω—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤, –∞ –Ω–µ —Å–∞–º–∏–º –∫–æ–¥–æ–º.