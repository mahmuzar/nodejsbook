–í Node.js –ø–æ—Ç–æ–∫–∏ (streams) ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ä—Ü–∏—è–º–∏, –∞ –Ω–µ —Ü–µ–ª–∏–∫–æ–º. –û–Ω–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω—ã –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –≤–∞–∂–Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—ë –≤ –ø–∞–º—è—Ç—å —Å—Ä–∞–∑—É.

## üîπ –¢–∏–ø—ã –ø–æ—Ç–æ–∫–æ–≤ –≤ Node.js

Node.js –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ –ø–æ—Ç–æ–∫–æ–≤, –≤—Å–µ –æ–Ω–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç stream –º–æ–¥—É–ª—è:
____

- Readable ‚Äî –ø–æ—Ç–æ–∫–∏, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, fs.createReadStream()).
- Writable ‚Äî –ø–æ—Ç–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, fs.createWriteStream()).
- Duplex ‚Äî –ø–æ—Ç–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ —á–∏—Ç–∞—é—Ç, –∏ –ø–∏—à—É—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, net.Socket).
- Transform ‚Äî –ø–æ–¥—Ç–∏–ø Duplex, –≥–¥–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫-—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, zlib.createGzip()).

## üîπ Backpressure (–æ–±—Ä–∞—Ç–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ)

Backpressure ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏, —á—Ç–æ–±—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, Readable) –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–ª –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Writable), –µ—Å–ª–∏ —Ç–æ—Ç –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.

- –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –æ–Ω —Å–æ–æ–±—â–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫—É: ¬´–ø–æ–¥–æ–∂–¥–∏¬ª.
- Node.js –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ .pipe() –∏–ª–∏ .write().
- –ú–µ—Ç–æ–¥ .write() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç false, –µ—Å–ª–∏ –±—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω ‚Äî —ç—Ç–æ —Å–∏–≥–Ω–∞–ª, —á—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á—Ç–µ–Ω–∏–µ.
- –ü–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ (—Å–æ–±—ã—Ç–∏–µ 'drain'), –º–æ–∂–Ω–æ –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å.

–ü—Ä–∏–º–µ—Ä:

```js
readStream.on('data', (chunk) => {
  if (!writeStream.write(chunk)) {
    readStream.pause(); // –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á—Ç–µ–Ω–∏–µ
  }
});

writeStream.on('drain', () => {
  readStream.resume(); // –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å —á—Ç–µ–Ω–∏–µ
});
```

> –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ .pipe() –≤—Å—è –ª–æ–≥–∏–∫–∞ backpressure —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üîπ Pipelining (–∫–æ–Ω–≤–µ–π–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)

Pipelining ‚Äî —ç—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –≤ —Ü–µ–ø–æ—á–∫—É: –≤—ã—Ö–æ–¥ –æ–¥–Ω–æ–≥–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Ö–æ–¥–æ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω–≤–µ–π–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—Ä:

```js
const fs = require('fs');
const zlib = require('zlib');

fs.createReadStream('input.txt')
  .pipe(zlib.createGzip())
  .pipe(fs.createWriteStream('input.txt.gz'));
```

 - –î–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí —Å–∂–∏–º–∞—é—Ç—Å—è ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª.
 - Backpressure –∑–¥–µ—Å—å —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: –µ—Å–ª–∏ —Å–∂–∞—Ç–∏–µ –∏–ª–∏ –∑–∞–ø–∏—Å—å –æ—Ç—Å—Ç–∞—ë—Ç ‚Äî —á—Ç–µ–Ω–∏–µ –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è.
 - –í Node.js v16+ –ø–æ—è–≤–∏–ª—Å—è —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–π –º–µ—Ç–æ–¥ stream.pipeline() (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ .pipe() –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö —Ü–µ–ø–æ—á–∫–∞—Ö):

```js
const { pipeline } = require('stream');
const fs = require('fs');
const zlib = require('zlib');

pipeline(
  fs.createReadStream('input.txt'),
  zlib.createGzip(),
  fs.createWriteStream('input.txt.gz'),
  (err) => {
    if (err) console.error('–û—à–∏–±–∫–∞:', err);
    else console.log('–ì–æ—Ç–æ–≤–æ');
  }
);
```

> pipeline() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏, –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø–æ—Ç–æ–∫–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ backpressure.

## üí° –†–µ–∑—é–º–µ

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è      | –°—É—Ç—å |
|----------------|------|
| **–¢–∏–ø—ã –ø–æ—Ç–æ–∫–æ–≤** | Readable, Writable, Duplex, Transform |
| **Backpressure** | –ú–µ—Ö–∞–Ω–∏–∑–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º –¥–∞–Ω–Ω—ã—Ö |
| **Pipelining**   | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö "–Ω–∞ –ª–µ—Ç—É" |

–ï—Å–ª–∏ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ç–µ–≤—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –∏–ª–∏ —Ñ–∞–π–ª–∞–º–∏ ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Node.js.